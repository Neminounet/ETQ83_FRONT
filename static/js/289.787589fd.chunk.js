"use strict";(self.webpackChunken_toute_quietude=self.webpackChunken_toute_quietude||[]).push([[289],{3570:function(e,t,n){n.d(t,{$8:function(){return o},cS:function(){return i},jn:function(){return l},nD:function(){return h}});var r=n(4165),a=n(5861),s="https://neminounet.pythonanywhere.com";function o(){return c.apply(this,arguments)}function c(){return(c=(0,a.Z)((0,r.Z)().mark((function e(){var t,n,a;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=window.localStorage.getItem("token"),e.next=3,fetch("".concat(s,"/availability/superuser/"),{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Token ".concat(t)}});case 3:return n=e.sent,e.next=6,n.json();case 6:if(a=e.sent,!n.ok){e.next=11;break}return e.abrupt("return",a);case 11:console.log(n.status,n.statusText);case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function i(){return u.apply(this,arguments)}function u(){return(u=(0,a.Z)((0,r.Z)().mark((function e(){var t,n,a;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=window.localStorage.getItem("token"),e.next=3,fetch("".concat(s,"/availability/user/"),{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Token ".concat(t)}});case 3:return n=e.sent,e.next=6,n.json();case 6:if(a=e.sent,!n.ok){e.next=11;break}return e.abrupt("return",a);case 11:console.log(n.status,n.statusText);case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function l(e,t){return d.apply(this,arguments)}function d(){return(d=(0,a.Z)((0,r.Z)().mark((function e(t,n){var a,c,i;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=window.localStorage.getItem("token"),e.next=3,fetch("".concat(s,"/availability/superuser/"),{method:"POST",body:JSON.stringify({date:t,heure:n}),headers:{"Content-Type":"application/json",Authorization:"Token ".concat(a)}});case 3:if(!(c=e.sent).ok){e.next=11;break}return e.next=7,o();case 7:return i=e.sent,e.abrupt("return",i);case 11:console.log(c.status,c.statusText);case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function h(e){return p.apply(this,arguments)}function p(){return(p=(0,a.Z)((0,r.Z)().mark((function e(t){var n,a,c;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=window.localStorage.getItem("token"),e.next=3,fetch("".concat(s,"/availability/superuser/").concat(t),{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:"Token ".concat(n)}});case 3:if(!(a=e.sent).ok){e.next=11;break}return e.next=7,o();case 7:return c=e.sent,e.abrupt("return",c);case 11:console.log(a.status,a.statusText);case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},7289:function(e,t,n){n.r(t),n.d(t,{default:function(){return N}});var r=n(4165),a=n(5861),s=n(7689),o=n(1087),c=n(1413),i=n(9439),u=n(2791),l=n(1224),d=n(6727),h=n(4695),p=n(1134),f="https://neminounet.pythonanywhere.com";function x(e){return m.apply(this,arguments)}function m(){return(m=(0,a.Z)((0,r.Z)().mark((function e(t){var n,a,s;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=window.localStorage.getItem("token"),e.next=3,fetch("".concat(f,"/availability/messages/?rdv_id=").concat(t),{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Token ".concat(n)}});case 3:if(!(a=e.sent).ok){e.next=11;break}return e.next=7,a.json();case 7:return s=e.sent,e.abrupt("return",s);case 11:return console.log(a.status,a.statusText),e.abrupt("return",null);case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function g(e){return v.apply(this,arguments)}function v(){return(v=(0,a.Z)((0,r.Z)().mark((function e(t){var n,a,s;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=window.localStorage.getItem("token"),e.next=3,fetch("".concat(f,"/availability/messages/"),{method:"POST",body:JSON.stringify(t),headers:{"Content-Type":"application/json",Authorization:"Token ".concat(n)}});case 3:if(!(a=e.sent).ok){e.next=11;break}return e.next=7,a.json();case 7:s=e.sent,console.log(s),e.next=12;break;case 11:console.log(a.status,a.statusText);case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function y(e){return j.apply(this,arguments)}function j(){return(j=(0,a.Z)((0,r.Z)().mark((function e(t){var n,a;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=window.localStorage.getItem("token"),e.next=3,fetch("".concat(f,"/availability/messages/").concat(t),{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:"Token ".concat(n)}});case 3:(a=e.sent).ok||console.log(a.status,a.statusText);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var k="Chat_messageContainer__piqya",w="Chat_messageHeader__C1TLF",b="Chat_messageContent__wsB7T",Z=n(184);var _=function(e){var t=e.rdv,n=(0,u.useContext)(l.Z).user,s=(0,u.useState)([]),o=(0,i.Z)(s,2),f=o[0],m=o[1],v=new Date;function j(e){var t=new Date(e);return"".concat(t.getDate()<10?"0"+t.getDate():t.getDate(),"-").concat(t.getMonth()<9?"0"+(t.getMonth()+1):t.getMonth()+1,"-").concat(t.getFullYear()," \xe0 ").concat(t.getHours()<10?"0"+t.getHours():t.getHours(),":").concat(t.getMinutes()<10?"0"+t.getMinutes():t.getMinutes(),":").concat(t.getSeconds()<10?"0"+t.getSeconds():t.getSeconds())}(0,u.useEffect)((function(){x(t.id).then((function(e){return m(e)}))}),[t]);var _,T=d.Ry({content:d.Z_().required("Vous devez \xe9crire quelque-chose ! :).").min(1,"Votre message doit contenir un minimum de un caract\xe8re.").max(1e3,"Votre message ne peut d\xe9passer les 1000 caract\xe8res.")}),S={content:""},D=(0,p.cI)({defaultValues:S,resolver:(0,h.X)(T)}),C=D.handleSubmit,N=D.register,M=D.reset,z=D.clearErrors,E=D.formState,V=E.errors,I=E.isSubmitting;function A(e){return R.apply(this,arguments)}function R(){return(R=(0,a.Z)((0,r.Z)().mark((function e(a){var s,o;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s={rdv:t.id,sender:n.id,content:a.content,date_time:(r=v,"".concat(r.getFullYear(),"-").concat(r.getMonth()<9?"0"+(r.getMonth()+1):r.getMonth()+1,"-").concat(r.getDate()<10?"0"+r.getDate():r.getDate(),"T").concat(r.getHours()<10?"0"+r.getHours():r.getHours(),":").concat(r.getMinutes()<10?"0"+r.getMinutes():r.getMinutes(),":").concat(r.getSeconds()<10?"0"+r.getSeconds():r.getSeconds()))},z(),e.next=4,g(s);case 4:return M(S),e.next=7,x(t.id);case 7:o=e.sent,m(o);case 9:case"end":return e.stop()}var r}),e)})))).apply(this,arguments)}function H(){return(H=(0,a.Z)((0,r.Z)().mark((function e(n){var a;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y(n);case 2:return e.next=4,x(t.id);case 4:a=e.sent,m(a);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return(0,Z.jsxs)("div",{className:"d-flex flex-column ai-center",children:[(0,Z.jsx)("h3",{className:"mb-20",children:"Messagerie"}),(0,Z.jsx)("div",{className:k,children:f.length>0?f.map((function(e,t){return(0,Z.jsxs)("div",{children:[(0,Z.jsxs)("div",{className:w,children:[(0,Z.jsx)("p",{children:(0,Z.jsxs)("small",{children:[e.sender.first_name," ",e.sender.last_name]})}),(0,Z.jsx)("p",{children:(0,Z.jsx)("small",{children:j(e.date_time)})})]}),(0,Z.jsxs)("div",{className:b,children:[(0,Z.jsx)("p",{children:e.content}),n.is_superuser&&(0,Z.jsx)("button",{onClick:function(){return function(e){return H.apply(this,arguments)}(e.id)},children:"x"})]})]},e.id)})):(0,Z.jsx)("h5",{children:"Pas de message"})}),t.availability.date>=(_=v,"".concat(_.getDate()<10?"0"+_.getDate():_.getDate(),"-").concat(_.getMonth()<9?"0"+(_.getMonth()+1):_.getMonth()+1,"-").concat(_.getFullYear()))&&(0,Z.jsxs)("form",{onSubmit:C(A),children:[(0,Z.jsxs)("div",{children:[(0,Z.jsx)("label",{htmlFor:"content",children:"Message"}),(0,Z.jsx)("textarea",(0,c.Z)((0,c.Z)({name:"content",id:"",cols:"40",rows:"5"},N("content")),{},{onKeyDown:function(e){"Enter"===e.key&&!1===e.shiftKey&&""!==e.target.value.trim()&&(e.preventDefault(),C(A)())}})),(null===V||void 0===V?void 0:V.content)&&(0,Z.jsx)("p",{className:"form-error",children:V.content.message})]}),(0,Z.jsx)("div",{children:(0,Z.jsx)("button",{disabled:I,children:"Envoyer message"})})]})]})},T="RendezVousDetail_componentContainer__SUk-7",S="RendezVousDetail_rdvDetailContainer__AK8OM",D="RendezVousDetail_rdvInfo__PZceK",C=n(3570);var N=function(){var e=(0,u.useContext)(l.Z).user,t=(0,s.f_)(),n=(0,s.s0)();function c(){return(c=(0,a.Z)((0,r.Z)().mark((function e(t){return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,C.nD)(t);case 2:n("../rendezvous");case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return(0,Z.jsxs)("div",{className:T,children:[(0,Z.jsx)("h1",{children:"Rendez-Vous"}),(0,Z.jsxs)("div",{className:S,children:[(0,Z.jsxs)("div",{className:"d-flex flex-column",children:[(0,Z.jsx)(o.OL,{className:"mb-20",to:"../rendezvous",children:(0,Z.jsx)("button",{children:(0,Z.jsx)("i",{className:"fa-solid fa-arrow-left"})})}),(0,Z.jsxs)("div",{className:D,children:[(0,Z.jsx)("h3",{children:"D\xe9tail du Rendez-vous"}),(0,Z.jsxs)("h5",{children:["RDV du : ",t.availability.date," \xe0 ",t.availability.heure]}),(0,Z.jsxs)("div",{className:"d-flex flex-column ai-center",children:[(0,Z.jsxs)("p",{className:"mt-20",children:["Etudiant : ",t.user.first_name," ",t.user.last_name]}),(0,Z.jsxs)("p",{className:"mt-20",children:["Niveau scolaire : ",t.degree]}),e.is_superuser&&(0,Z.jsx)("button",{className:"mt-20 delete",onClick:function(){return function(e){return c.apply(this,arguments)}(t.availability.id)},children:"Supprimer RDV"})]})]})]}),(0,Z.jsx)("div",{children:(0,Z.jsx)(_,{rdv:t})})]})]})}}}]);
//# sourceMappingURL=289.787589fd.chunk.js.map