"use strict";(self.webpackChunken_toute_quietude=self.webpackChunken_toute_quietude||[]).push([[208],{3570:function(e,t,n){n.d(t,{$8:function(){return a},cS:function(){return o},jn:function(){return l},nD:function(){return h}});var r=n(4165),i=n(5861),s="https://neminounet.pythonanywhere.com";function a(){return u.apply(this,arguments)}function u(){return(u=(0,i.Z)((0,r.Z)().mark((function e(){var t,n,i;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=window.localStorage.getItem("token"),e.next=3,fetch("".concat(s,"/availability/superuser/"),{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Token ".concat(t)}});case 3:return n=e.sent,e.next=6,n.json();case 6:if(i=e.sent,!n.ok){e.next=11;break}return e.abrupt("return",i);case 11:console.log(n.status,n.statusText);case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function o(){return c.apply(this,arguments)}function c(){return(c=(0,i.Z)((0,r.Z)().mark((function e(){var t,n,i;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=window.localStorage.getItem("token"),e.next=3,fetch("".concat(s,"/availability/user/"),{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Token ".concat(t)}});case 3:return n=e.sent,e.next=6,n.json();case 6:if(i=e.sent,!n.ok){e.next=11;break}return e.abrupt("return",i);case 11:console.log(n.status,n.statusText);case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function l(e,t){return d.apply(this,arguments)}function d(){return(d=(0,i.Z)((0,r.Z)().mark((function e(t,n){var i,u,o;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=window.localStorage.getItem("token"),e.next=3,fetch("".concat(s,"/availability/superuser/"),{method:"POST",body:JSON.stringify({date:t,heure:n}),headers:{"Content-Type":"application/json",Authorization:"Token ".concat(i)}});case 3:if(!(u=e.sent).ok){e.next=11;break}return e.next=7,a();case 7:return o=e.sent,e.abrupt("return",o);case 11:console.log(u.status,u.statusText);case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function h(e){return f.apply(this,arguments)}function f(){return(f=(0,i.Z)((0,r.Z)().mark((function e(t){var n,i,u;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=window.localStorage.getItem("token"),e.next=3,fetch("".concat(s,"/availability/superuser/").concat(t),{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:"Token ".concat(n)}});case 3:if(!(i=e.sent).ok){e.next=11;break}return e.next=7,a();case 7:return u=e.sent,e.abrupt("return",u);case 11:console.log(i.status,i.statusText);case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},1208:function(e,t,n){n.r(t),n.d(t,{default:function(){return g}});var r=n(4165),i=n(5861),s=n(9439),a=n(2791),u=n(1413),o=n(6727),c=n(4695),l=n(1134),d=n(1224),h=n(3570),f=n(184);var p=function(e){var t,n=e.postRDV,p=e.getAllRDV,v=e.setRDVList,x=e.today,m=(0,a.useContext)(d.Z).user,j=(0,a.useState)([]),b=(0,s.Z)(j,2),y=b[0],g=b[1],Z=(0,a.useState)(""),_=(0,s.Z)(Z,2),k=_[0],w=_[1],z=o.Ry({degree:o.Z_().required("vous devez choisir une classe"),date:o.Z_().required("Vous devez choisir une date"),heure:o.Z_().required("Vous devez choisir une heure")}),C={degree:"",date:"",heure:""},S=(0,l.cI)({defaultValues:C,resolver:(0,c.X)(z)}),N=S.handleSubmit,T=S.register,R=S.reset,V=S.formState.isSubmitting;function D(){return E.apply(this,arguments)}function E(){return(E=(0,i.Z)((0,r.Z)().mark((function e(){var t,n;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,h.cS)();case 2:(t=e.sent)?(n=t.reduce((function(e,t){return e[t.date]||(e[t.date]=[]),e[t.date].push({id:t.id,heure:t.heure,is_taken:t.is_taken}),e}),{}),g(n)):g([]);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function L(){return(L=(0,i.Z)((0,r.Z)().mark((function e(t){var i,s;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i={user:m.id,degree:t.degree,availability:t.heure},e.next=3,n(i);case 3:return R(C),e.next=6,D();case 6:return e.next=8,p();case 8:s=e.sent,v(s);case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return(0,a.useEffect)((function(){D()}),[]),console.log(y),(0,f.jsx)("div",{children:(0,f.jsxs)("form",{onSubmit:N((function(e){return L.apply(this,arguments)})),children:[(0,f.jsxs)("div",{className:"d-flex flex-column",children:[(0,f.jsx)("label",{htmlFor:"degree",children:"Selectionner la classe"}),(0,f.jsxs)("select",(0,u.Z)((0,u.Z)({name:"degree"},T("degree")),{},{children:[(0,f.jsx)("option",{value:"",disabled:!0,children:"Choisissez une classe"}),["CP","CE1","CE2","CM1","CM2","6E","5E","4E","3E"].map((function(e,t){return(0,f.jsx)("option",{value:e,children:e},t)}))]}))]}),(0,f.jsxs)("div",{children:[(0,f.jsx)("label",{htmlFor:"date",children:"Selectionner la date"}),(0,f.jsxs)("select",(0,u.Z)((0,u.Z)({name:"date"},T("date")),{},{onChange:function(e){return w(e.target.value)},children:[(0,f.jsx)("option",{value:"",disabled:!0,children:"Choisissez une date"}),Object.keys(y).filter((function(e){return e>=x})).map((function(e,t){return(0,f.jsx)("option",{value:e,children:e},t)}))]}))]}),(0,f.jsxs)("div",{children:[(0,f.jsx)("label",{htmlFor:"heure",children:"Selectionner l'heure"}),(0,f.jsxs)("select",(0,u.Z)((0,u.Z)({name:"heure"},T("heure")),{},{children:[(0,f.jsx)("option",{value:"",disabled:!0,children:"Choisissez une heure"}),null===(t=y[k])||void 0===t?void 0:t.filter((function(e){return!0!==e.is_taken})).map((function(e,t){return(0,f.jsx)("option",{value:e.id,children:e.heure},t)}))]}))]}),(0,f.jsx)("div",{children:(0,f.jsx)("button",{disabled:V,children:"Prendre RDV"})})]})})},v=n(1087);var x=function(e){var t=e.rdvList,n=e.today,r=e.user,i=(0,a.useState)(""),u=(0,s.Z)(i,2),o=u[0],c=u[1],l=(0,a.useState)(""),d=(0,s.Z)(l,2),h=d[0],p=d[1];return(0,f.jsxs)("div",{className:"d-flex flex-column",children:[(0,f.jsxs)("form",{children:[(0,f.jsxs)("div",{children:[(0,f.jsx)("label",{htmlFor:"year",children:"Selectionner l'ann\xe9e"}),(0,f.jsxs)("select",{name:"year",onChange:function(e){return c(e.target.value)},children:[(0,f.jsx)("option",{value:"",disabled:!0,children:"Choisissez une ann\xe9e"}),["2023","2024","2025","2026","2027","2028","2029","2030"].map((function(e,t){return(0,f.jsx)("option",{value:e,children:e},t)}))]})]}),(0,f.jsxs)("div",{children:[(0,f.jsx)("label",{htmlFor:"month",children:"Selectionner le mois"}),(0,f.jsxs)("select",{name:"month",onChange:function(e){return p(e.target.value)},children:[(0,f.jsx)("option",{value:"",disabled:!0,children:"Choisissez un mois"}),["01","02","03","04","05","06","07","08","09","10","11","12"].map((function(e,t){return(0,f.jsx)("option",{value:e,children:e},t)}))]})]})]}),r.is_superuser?t.filter((function(e){return e.availability.date.includes(o)})).filter((function(e){return e.availability.date.includes("-".concat(h,"-"))})).filter((function(e){return e.availability.date<n})).map((function(e){return(0,f.jsx)(v.OL,{to:"../rendezvous/".concat(e.id),children:(0,f.jsxs)("button",{className:"rdv mb-20",children:["Niveau : ",e.degree," le ",e.availability.date," \xe0 ",e.availability.heure," ",e.user.first_name," ",e.user.last_name]},e.id)},e.id)})):t.filter((function(e){return e.availability.date.includes(o)})).filter((function(e){return e.availability.date.includes("-".concat(h,"-"))})).filter((function(e){return e.availability.date<n})).filter((function(e){return e.user.id===r.id})).map((function(e){return(0,f.jsx)(v.OL,{to:"../rendezvous/".concat(e.id),children:(0,f.jsxs)("button",{className:"rdv mb-20",children:["Niveau : ",e.degree," le ",e.availability.date," \xe0 ",e.availability.heure," ",e.user.first_name," ",e.user.last_name]},e.id)},e.id)}))]})},m=n(1938),j="RendezVous_rdvContainer__S1d+s",b="RendezVous_rdvContent__FXbss",y="RendezVous_rdvBox__vOBm0";var g=function(){var e=(0,a.useContext)(d.Z).user,t=new Date,n="".concat(t.getDate()<10?"0"+t.getDate():t.getDate(),"-").concat(t.getMonth()<9?"0"+(t.getMonth()+1):t.getMonth()+1,"-").concat(t.getFullYear()),u=(0,a.useState)([]),o=(0,s.Z)(u,2),c=o[0],l=o[1];return(0,a.useEffect)((function(){function e(){return(e=(0,i.Z)((0,r.Z)().mark((function e(){var t;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,m.A$)();case 2:t=e.sent,l(t||[]);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[]),(0,f.jsxs)("div",{className:j,children:[(0,f.jsx)("h2",{children:"Rendez-Vous"}),(0,f.jsxs)("div",{className:b,children:[(0,f.jsxs)("div",{className:y,children:[(0,f.jsx)("h3",{children:"Rendez-vous \xe0 venir"}),e.is_superuser?c.length>0?c.filter((function(e){return e.availability.date>=n})).map((function(t){return(0,f.jsx)(v.OL,{to:"../rendezvous/".concat(t.id),children:(0,f.jsxs)("button",{className:"m-10",disabled:t.availability.date>n&&!e.is_superuser,children:["Niveau : ",t.degree," le ",t.availability.date," \xe0 ",t.availability.heure," ",e.is_superuser?t.user.first_name:""," ",e.is_superuser?t.user.last_name:""]})},t.id)})):(0,f.jsx)("p",{children:"Pas de rendez-vous de plannifi\xe9"}):c.length>0?c.filter((function(e){return e.availability.date>=n})).filter((function(t){return t.user.id===e.id})).map((function(t){return(0,f.jsx)(v.OL,{to:"../rendezvous/".concat(t.id),children:(0,f.jsxs)("button",{className:"m-10",children:["Niveau : ",t.degree," le ",t.availability.date," \xe0 ",t.availability.heure," ",e.is_superuser?t.user.first_name:""," ",e.is_superuser?t.user.last_name:""]})},t.id)})):(0,f.jsx)("p",{children:"Pas de rendez-vous de plannifi\xe9"})]}),!e.is_superuser&&(0,f.jsxs)("div",{className:y,children:[(0,f.jsx)("h3",{children:"Prendre Rendez-vous"}),(0,f.jsx)(p,{postRDV:m.ey,getAllRDV:m.A$,setRDVList:l,today:n})]}),(0,f.jsxs)("div",{className:y,children:[(0,f.jsx)("h3",{children:"Historique"}),(0,f.jsx)(x,{rdvList:c,today:n,user:e})]})]})]})}}}]);
//# sourceMappingURL=208.55ebb9dc.chunk.js.map